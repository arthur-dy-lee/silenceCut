# SilenceCut v2.0 - 自动静音剪辑工具

基于 Python + PyQt6 的本地桌面客户端，可自动检测并删除/加速视频中的静音片段。

## 功能特性

- 🎬 **自动静音检测** - 智能识别视频中的静音片段
- ⚡ **GPU/CPU 编码** - 支持 NVIDIA NVENC 硬件加速
- 📁 **批量处理** - 支持多文件串行/并行处理 (默认并行)
- 🖱️ **拖拽添加** - 直接拖拽视频文件到窗口
- 💾 **参数记忆** - 自动保存用户设置
- 🎛️ **灵活配置** - 所有参数可视化调整
- 🌍 **中英文切换** - 支持中文和英文界面
- 🎨 **明暗主题** - 支持浅色和深色主题
- 📂 **智能输出** - 默认输出到源文件目录，也可自定义

## 系统要求

- Windows 10/11 (64-bit)
- Python 3.9+
- FFmpeg (需添加到系统 PATH)
- NVIDIA GPU (可选，用于硬件加速编码)

## 安装步骤

### 1. 安装 FFmpeg

1. 下载 FFmpeg: https://ffmpeg.org/download.html
2. 解压到任意目录，如 `C:\ffmpeg`
3. 将 `C:\ffmpeg\bin` 添加到系统环境变量 PATH
4. 验证安装: 打开命令提示符，输入 `ffmpeg -version`

### 2. 安装 Python 依赖

```bash
# 创建虚拟环境 (可选但推荐)
python -m venv venv
venv\Scripts\activate

# 安装依赖
pip install -r requirements.txt
```

### 3. 运行程序

```bash
python silence_cut_gui.py
```

### 4. 打包为 EXE (可选)

```bash
# 双击运行 build.bat
# 或手动执行:
pyinstaller --onefile --windowed --name SilenceCut silence_cut_gui.py
```

## 参数说明

### 静音处理参数

| 参数 | 默认值 | 说明 |
|------|--------|------|
| 静音速度 | 999 | 静音片段的播放速度，≥100 表示删除该片段，2-4 表示加速但保留 |
| 有声速度 | 1.0 | 有声片段的播放速度，1.0=原速，1.5=加速1.5倍 (通常保持1.0) |
| 视频全局加速 | **1.2** | 最终输出视频的整体加速倍率，1.2=整体加速20% |
| 边界缓冲帧 | 3 | 静音/有声边界的缓冲帧数，防止切割过于生硬 |
| 静音阈值 | 0.025 | 音量低于此阈值视为静音 (0-1)，值越小检测越敏感 |
| 最小静音(ms) | 300 | 最短静音时长，低于此值不处理 |

### 编码设置

| 选项 | 说明 |
|------|------|
| GPU (NVENC) | 使用 NVIDIA 显卡硬件编码，速度快 |
| CPU (libx264) | 使用 CPU 软件编码，兼容性好 |
| Pydub | 使用 Pydub 库检测静音，精度高 |
| NumPy | 使用 NumPy 检测静音，速度快 |
| 串行 | 依次处理每个文件 |
| 并行 (默认) | 同时处理多个文件 (GPU 模式建议 ≤2) |

### 输出设置

| 选项 | 说明 |
|------|------|
| ✅ 输出到源文件目录 (默认推荐) | 输出文件保存在源视频同目录，文件名添加时间戳后缀 |
| 自定义输出目录 | 所有输出文件保存到指定目录 |

## 使用技巧

1. **快速删除静音**: 保持默认设置 (静音速度=999) 即可删除所有静音
2. **保留部分静音**: 将静音速度设为 2-4，可加速但不完全删除
3. **整体加速**: 设置全局加速为 1.2-1.5 可适当加快节奏
4. **敏感内容**: 降低静音阈值 (如 0.01) 可检测更轻的声音
5. **长视频**: 使用 GPU 编码 + 串行处理，避免内存不足

## 常见问题

### Q: 提示找不到 ffmpeg
A: 请确保 FFmpeg 已正确安装并添加到系统 PATH

### Q: GPU 编码不可用
A: 需要 NVIDIA 显卡并安装最新驱动。没有显卡会自动切换到 CPU 编码

### Q: 处理很慢
A: 检查是否使用了 GPU 编码；大文件建议使用串行处理

### Q: 输出视频有问题
A: 尝试调整边界缓冲帧数或静音阈值

## 项目结构

```
silence_cut_app/
├── silence_cut_gui.py   # 主程序
├── requirements.txt     # 依赖列表
├── build.bat           # 打包脚本
├── README.md           # 本文档
└── icon.ico            # 程序图标 (可选)
```

## 技术栈

- **GUI**: PyQt6
- **音频处理**: Pydub, SciPy, NumPy
- **视频处理**: FFmpeg
- **打包**: PyInstaller

## 许可证

MIT License
